(()=>{"use strict";const e=()=>{const e=document.createElement("div");return e.classList.add("heart"),e},t=(e,t,r)=>{let o,s=Math.floor(60*Math.random()+20);return"asteroid"==e?o=((e,t,r)=>{const o=document.createElement("div");return o.classList.add("asteroid"),o.style.left=e+"%",o.style.bottom="100%",o.style.animationDuration=r+"s",o})(s,0,t):"powerUp"==e&&(o=((e,t,r,o)=>{const a=document.createElement("div");return a.classList.add("powerUp",e+"PU"),a.style.left=r+"%",a.style.bottom="100%",a.style.animationDuration=t+"s",a.style.backgroundImage="url(./img/"+e+"PowerUp.png)",a})(r,t,s)),a.appendElement(o),{getLocation:e=>"x"==e?o.left:o.bottom,getUI:()=>o,powerUpName:r}},r=(()=>{let e=0,t=0;const r=[],o=[],s={x:50,y:45,shield:!1};let i=0;try{null!=localStorage.getItem("record")&&(i=localStorage.getItem("record"))}catch(e){}return{getRocket:e=>s[e],setRocket:(e,t)=>s[e]=t,hasShield:()=>s.shield,addShield:e=>{s.shield=!0,a.addShield(e)},removeShield:()=>s.shield=!1,removeAsteroid:e=>{setTimeout((()=>{a.removeElement(r.shift().getUI())}),e)},addAsteroid:e=>r.push(e),getAsteroids:()=>r,removePowerUp:e=>{setTimeout((()=>{a.removeElement(o.shift().getUI())}),e)},addPowerUp:e=>o.push(e),getPowerUps:()=>o,getTime:()=>t,addTime:()=>t++,resetTime:()=>t=0,getLives:()=>e,updateLives:t=>e+=t,gameOn:()=>!0,gameStatus:!0,getRecord:()=>i,verifyAndSetRecord:e=>{let t=!1;e>i&&(t=!0),i=e>i?e:i;try{localStorage.setItem("record",i)}catch(e){}return t}}})(),o=(()=>{let e,o,i;const c=e=>{r.updateLives(e),a.updateHearts()},d=()=>{let e=a.getActualRocket(),t=e.left,o=e.top;r.getPowerUps().forEach((s=>{let i=s.getUI().getBoundingClientRect(),d=i.left,n=i.top;o+e.height<n||o>n+i.height||t+e.width<d||t>d+i.width||("heart"==s.powerUpName?c(1):"shield"==s.powerUpName&&(r.removeShield(),a.removeShield(),r.addShield(8)),a.removeElement(document.querySelector("."+s.powerUpName+"PU")))})),r.hasShield()||r.getAsteroids().forEach((a=>{let i=a.getUI().getBoundingClientRect(),d=i.left,n=i.top;if(!(o+e.height<n||o>n+i.height||t+e.width<d||t>d+i.width)){if(c(-1),0==r.getLives())return void s.stop();r.addShield(3.5)}}))},n=(e,o)=>{let a=3-Math.log10(Math.abs(.75*r.getTime()-6));"asteroid"==e?(r.addAsteroid(t(e,a)),r.removeAsteroid(1e3*a)):"powerUp"==e&&(r.addPowerUp(t(e,a,o)),r.removePowerUp(1e3*a))},l=()=>{a.appendElement(((e,t)=>{const r=document.createElement("div");return r.classList.add("rocket"),r.style.left="50%",r.style.bottom="calc(45% - 69px)",r})())};return{checkMove:e=>{if(r.gameOn()){if("ArrowLeft"==e||"a"==e){if(r.getRocket("x")<=15)return;r.setRocket("x",r.getRocket("x")-7)}else if("ArrowRight"==e||"d"==e){if(r.getRocket("x")>=85)return;r.setRocket("x",r.getRocket("x")+7)}else if("ArrowUp"==e||"w"==e){if(r.getRocket("y")>=80)return;r.setRocket("y",r.getRocket("y")+7)}else if("ArrowDown"==e||"s"==e){if(r.getRocket("y")<=20)return;r.setRocket("y",r.getRocket("y")-7)}a.moveRocket()}},checkCrash:d,createObject:n,createRocket:l,changeLives:c,startGame:()=>{r.resetTime(),c(3),l(),a.startRocket(),a.start(),e=setInterval((()=>{r.addTime(),a.updateScore()}),1e3);let t=()=>{0!=r.gameOn()&&(n("asteroid"),i=setTimeout(t,2e3-Math.min(50*r.getTime(),1550)))};t(),o=setInterval((()=>{d()}),70)},stopGame:()=>{clearInterval(e);let t=r.verifyAndSetRecord(10*r.getTime());r.resetTime(),r.setRocket("x",50),r.setRocket("y",45),clearInterval(o),clearTimeout(i),a.stop(t),r.gameStatus=!1}}})(),a=(()=>{const t=document.querySelector("#container"),a=document.querySelector(".score");a.innerHTML=`RECORD: <span>${r.getRecord()}</span>`;let s=document.querySelector("#score");const i=document.querySelector(".hearts");let c,d;return{moveRocket:()=>{c.style.left=r.getRocket("x")+"%",c.style.bottom="calc("+r.getRocket("y")+"% - 69px)"},getActualRocket:()=>c.getBoundingClientRect(),score:s,appendElement:e=>{t.appendChild(e)},removeElement:e=>{t.removeChild(e)},updateScore:()=>{s.textContent=10*r.getTime()},updateHearts:()=>{let t=r.getLives(),o=i.childElementCount,a=t-o;if(a<0){if(0==o)return;for(;0!=a;)i.removeChild(i.lastChild),a++}else for(;0!=a;)i.appendChild(e()),a--},startRocket:()=>{c=document.querySelector(".rocket")},addShield:e=>{c.classList.add("shield"),c.style.animationDuration=e+"s",d=setTimeout((()=>{c.classList.remove("shield"),r.removeShield()}),1e3*e)},removeShield:()=>{c.classList.remove("shield"),clearTimeout(d)},start:()=>{try{t.removeChild(document.querySelector(".start"))}catch(e){}try{t.removeChild(document.querySelector(".gameOver"))}catch(e){}t.style.animation="moveSky 14s linear infinite",window.addEventListener("keyup",(e=>{o.checkMove(e.key)})),a.innerHTML='SCORE: <span id="score">0</span>',s=document.querySelector("#score"),null==document.querySelector(".audio")?t.appendChild((()=>{const e=document.createElement("audio");return e.classList.add("audio"),e.innerHTML='<audio autoplay loop><source src="./music.mp3" type="audio/mpeg"></audio>',e})()):document.querySelector(".audio").play()},stop:e=>{window.removeEventListener("keyup",(e=>{o.checkMove(e.key)})),t.removeChild(c),a.innerHTML=`RECORD: ${e?"(NEW)":""} <span>${r.getRecord()}</span>`,t.style.animation="",t.removeChild(document.querySelector(".audio")),t.appendChild((()=>{const e=document.createElement("div");return e.classList.add("gameOver"),e.innerHTML='<div><img src="./img/gameOver.png" class="text"></div>',e.innerHTML+='<div class="buttonDiv"><button id="start"></button></div>',e})())}}})(),s=(()=>{let e=document.querySelector("button#start");const t=()=>{o.startGame(),i.start();try{e.removeEventListener("click",t)}catch(e){}};return e.addEventListener("click",t),{start:t,stop:()=>{o.stopGame(),i.stop(),e=document.querySelector("button#start"),e.addEventListener("click",(()=>{t()}))}}})(),i=(()=>{let e,t;return{start:()=>{e=setInterval((()=>{Math.random()<.8&&o.createObject("powerUp","heart")}),7500),t=setInterval((()=>{Math.random()<.85&&o.createObject("powerUp","shield")}),13e3)},stop:()=>{clearInterval(e),clearInterval(t)}}})()})();